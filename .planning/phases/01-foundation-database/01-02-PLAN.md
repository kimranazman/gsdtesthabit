# Plan 01-02: Database Schema, Drizzle ORM Connection, and Seed Data

## Goal
Set up Drizzle ORM connected to local PostgreSQL, define schema for habits/completions/categories, push schema, and create seed script with 3 example habits.

## Steps

1. Create local PostgreSQL database `habittracker`
2. Install database dependencies: `drizzle-orm`, `pg`, `@types/pg`, `drizzle-kit`
3. Create `.env.local` with `DATABASE_URL=postgresql://khairul@localhost:5432/habittracker`
4. Create `src/lib/db/index.ts` - database connection using `drizzle-orm/node-postgres`
5. Create `src/lib/db/schema.ts` - Drizzle schema definitions:
   - `categories` table: id, name, color, created_at
   - `habits` table: id, name, description, frequency, frequency_days, color, icon, category_id, position, archived, created_at, updated_at
   - `completions` table: id, habit_id, completed_date, notes, created_at
   - Unique constraint on (habit_id, completed_date)
   - Proper indexes
6. Create `drizzle.config.ts` for drizzle-kit
7. Push schema with `npx drizzle-kit push`
8. Create `src/lib/db/seed.ts` - seed script that:
   - Creates 2 categories: "Health" and "Productivity"
   - Creates 3 habits: "Morning Exercise" (daily), "Read 30 Minutes" (daily), "Weekly Review" (weekly)
   - Creates ~30 days of historical completion data with realistic patterns
9. Add `seed` script to package.json
10. Run seed script to populate data

## Files Created/Modified
- `.env.local` - database connection string
- `src/lib/db/index.ts` - database connection
- `src/lib/db/schema.ts` - Drizzle schema
- `src/lib/db/seed.ts` - seed data script
- `drizzle.config.ts` - Drizzle Kit config
- `package.json` - add seed script

## Verification
- `npx drizzle-kit push` completes without errors
- Running seed script populates the database
- Can query habits from the database via a test query

## Decision
- Use UUID for primary keys (consistent with research architecture)
- Use `date` type for completed_date (not timestamp, per STATE.md decision)
- Use `pg` package directly for local development (swap to @vercel/postgres for production)
